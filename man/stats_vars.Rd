% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stats_vars.R
\name{stats_vars}
\alias{stats_vars}
\title{Compute Specified Statistics from Climate Rasters}
\usage{
stats_vars(
  variable_path,
  n_units,
  stats = c("mean", "max", "min"),
  period = 3,
  period_stats = "mean",
  circular = TRUE,
  inter_variable_path = NULL,
  inter_stats = NULL,
  max_unit_path = NULL,
  min_unit_path = NULL,
  max_period_path = NULL,
  min_period_path = NULL,
  max_interactive_path = NULL,
  min_interactive_path = NULL,
  prefix_variable = "var",
  suffix_inter_max = "inter_high",
  suffix_inter_min = "inter_low",
  user_region = NULL,
  tile_degrees = 5,
  temp_dir = tempdir(),
  write_raw_vars = FALSE,
  ...
)
}
\arguments{
\item{variable_path}{Character vector of `n_units` paths to the primary variable rasters.}

\item{n_units}{Integer. The number of temporal units (layers) per input variable.}

\item{stats}{Character vector. Statistics to compute for the primary variable.
Possible values: "mean", "max", "min", "sum", "stdev", "cv_cli",
"max_period", "min_period".}

\item{period}{Integer. The number of units defining a "period" for period-based stats. Default: 3.}

\item{period_stats}{Character. Statistic to summarize periods by ("mean" or "sum"). Default: "mean".}

\item{circular}{Logical. Calculate periods wrapping around the cycle? Default: TRUE.}

\item{inter_variable_path}{Optional. Character vector of `n_units` paths to an
interactive variable's rasters.}

\item{inter_stats}{Character vector. Interactive statistics to compute.
Requires `inter_variable_path`. Possible values: "max_inter", "min_inter".
These calculate the primary variable's period value corresponding to the
interactive variable's max/min period.}

\item{max_unit_path}{Optional. Path to a single-layer raster specifying the unit (1-based index)
to use for "max" statistic if provided (overrides dynamic calculation).}

\item{min_unit_path}{Optional. Path to a single-layer raster specifying the unit (1-based index)
to use for "min" statistic if provided.}

\item{max_period_path}{Optional. Path to a single-layer raster specifying the period (1-based index)
to use for "max_period" statistic if provided.}

\item{min_period_path}{Optional. Path to a single-layer raster specifying the period (1-based index)
to use for "min_period" statistic if provided.}

\item{max_interactive_path}{Optional. Path to a single-layer raster specifying the period (1-based index)
of the interactive variable to use for "max_inter" statistic.}

\item{min_interactive_path}{Optional. Path to a single-layer raster specifying the period (1-based index)
of the interactive variable to use for "min_inter" statistic.}

\item{prefix_variable}{Character. Prefix for output statistic names. Default: "var".}

\item{suffix_inter_max}{Character. Suffix for the "max_inter" statistic name. Default: "inter_high".}

\item{suffix_inter_min}{Character. Suffix for the "min_inter" statistic name. Default: "inter_low".}

\item{user_region}{Optional. An `sf` or `terra::SpatVector` object defining the
processing area. If `NULL`, the full extent of the input rasters is used.}

\item{tile_degrees}{Numeric. Approximate size of processing tiles in degrees. Default: 5.}

\item{temp_dir}{Character. Path for temporary tile files. Default: `tempdir()`.}

\item{write_raw_vars}{Logical. Save intermediate extracted climate data. Default: FALSE.}

\item{...}{Additional arguments (currently unused but kept for consistency).}
}
\value{
Character string: Path to the temporary directory containing intermediate `.qs` files.
}
\description{
Calculates specified summary statistics from input variable rasters
with user-defined temporal units, optionally using an interactive variable
and static indices. AOI is defined by `user_region` or defaults to the
full raster extent. Uses parallel processing, spatial tiling, and `exactextractr`.
}
\details{
This function processes multi-temporal raster data tile by tile in parallel.
For each tile:
1. Data is extracted from input rasters into matrices (pixels x time-units).
2. Requested statistics are calculated using matrix operations (often via `Rfast`).
   - "cv_cli" is calculated as `(stdev / (1 + mean)) * 100`.
   - Period stats ("max_period", "min_period") use summaries of the primary variable over sliding windows.
   - Interactive stats ("max_inter", "min_inter") use the primary variable's period summary
     corresponding to the period where the interactive variable is maximal or minimal.
3. Static index rasters (e.g., `max_unit_path`) can override dynamic identification of
   units or periods for specific statistics.
4. Results for each statistic are saved as `.qs` files (value + cell_id).
}
