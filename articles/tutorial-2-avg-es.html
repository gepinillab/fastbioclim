<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cálculo de Promedios Temporales con `fastbioclim` • fastbioclim</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cálculo de Promedios Temporales con `fastbioclim`">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fastbioclim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0-9999</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>[ENGLISH]</h6></li>
    <li><a class="dropdown-item" href="../articles/tutorial-1-intro-en.html">Bioclimatics (Intro)</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-2-avg-en.html">Averages</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>[ESPAÑOL]</h6></li>
    <li><a class="dropdown-item" href="../articles/tutorial-1-intro-es.html">Bioclimaticas (Intro)</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-2-avg-es.html">Promedios</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gepinillab/fastbioclim/"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Cálculo de Promedios Temporales con `fastbioclim`</h1>
                        <h4 data-toc-skip class="author">Gonzalo E.
Pinilla-Buitrago</h4>
            
            <h4 data-toc-skip class="date">11-08-2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gepinillab/fastbioclim/blob/main/vignettes/tutorial-2-avg-es.Rmd" class="external-link"><code>vignettes/tutorial-2-avg-es.Rmd</code></a></small>
      <div class="d-none name"><code>tutorial-2-avg-es.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introducción">Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n"></a>
</h2>
<p>En el análisis de datos climáticos y ambientales, una tarea
fundamental es resumir series de tiempo de datos ráster. Esto nos
permite, por ejemplo, calcular “climatologías” o entender cómo han
cambiado las condiciones a lo largo del tiempo.</p>
<p>El paquete <code>fastbioclim</code> ofrece dos funciones potentes y
eficientes para esta tarea:</p>
<ol style="list-style-type: decimal">
<li>
<code><a href="../reference/calculate_average.html">calculate_average()</a></code>: Calcula un <strong>promedio
climatológico estático</strong>. Responde a la pregunta: <em>“¿Cuál es
la temperatura máxima promedio para todos los eneros en mi serie de
tiempo?”</em>.</li>
<li>
<code><a href="../reference/calculate_roll.html">calculate_roll()</a></code>: Calcula un <strong>promedio
climatológico móvil (rodante)</strong>. Responde a la pregunta:
<em>“¿Cómo ha cambaido el promedio de enero a lo largo de diferentes
ventanas de tiempo?”</em>.</li>
</ol>
<p>En este tutorial, exploraremos cómo usar ambas funciones utilizando
un conjunto de datos de ejemplo de temperatura máxima mensual para
Belice.</p>
</div>
<div class="section level2">
<h2 id="configuración-del-entorno">1. Configuración del Entorno<a class="anchor" aria-label="anchor" href="#configuraci%C3%B3n-del-entorno"></a>
</h2>
<p>Antes de empezar, necesitamos cargar los paquetes necesarios.
<code>fastbioclim</code> es el paquete principal, <code>terra</code> se
usa para manejar los datos ráster, y <code>progressr</code> junto con
<code>future</code> nos permitirán ver barras de progreso y ejecutar los
cálculos en paralelo para mayor eficiencia.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cargar los paquetes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gepinillab.github.io/fastbioclim/">fastbioclim</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## terra 1.8.60</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org" class="external-link">progressr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Configurar el procesamiento en paralelo para acelerar los cálculos</span></span>
<span><span class="co"># Usaremos solo un núcleo en este ejemplo. OPCIONAL</span></span>
<span><span class="co"># future::plan("sequential")</span></span>
<span></span>
<span><span class="co"># Habilitar las barras de progreso globales para ver el avance. OPCIONAL</span></span>
<span><span class="co"># progressr::handlers(global = TRUE)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="cargar-los-datos-de-ejemplo">2. Cargar los Datos de Ejemplo<a class="anchor" aria-label="anchor" href="#cargar-los-datos-de-ejemplo"></a>
</h2>
<p>Utilizaremos una serie de tiempo de temperatura máxima
(<code>tmax</code>) para Belice, que viene incluida en un paquete de
datos de ejemplo. Esta serie contiene 39 años de datos mensuales (468
capas en total).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtener la ruta a los archivos de ejemplo</span></span>
<span><span class="co"># system.file() busca archivos dentro de un paquete instalado</span></span>
<span><span class="va">tmax_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/belize/"</span>, package <span class="op">=</span> <span class="st">"egdata.fastbioclim"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Cargar los archivos como un único objeto SpatRaster de terra</span></span>
<span><span class="va">tmax_bel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">tmax_paths</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verifiquemos la estructura de nuestros datos</span></span>
<span><span class="co"># Deberíamos tener 468 capas, que corresponden a 12 meses * 39 años</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tmax_bel</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## size        : 314, 134, 468  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 0.008333333, 0.008333333  (x, y)</span></span>
<span><span class="co">## extent      : -89.22514, -88.10847, 15.88319, 18.49986  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">## sources     : 1980-01.tif  </span></span>
<span><span class="co">##               1980-02.tif  </span></span>
<span><span class="co">##               1980-03.tif  </span></span>
<span><span class="co">##               ... and 465 more sources</span></span>
<span><span class="co">## names       : 1980-01, 1980-02, 1980-03, 1980-04, 1980-05, 1980-06, ... </span></span>
<span><span class="co">## min values  :     220,     217,     248,     253,     270,     240, ... </span></span>
<span><span class="co">## max values  :     276,     278,     317,     316,     334,     299, ...</span></span></code></pre>
<p>Como podemos ver, <code>tmax_bel</code> es un <code>SpatRaster</code>
con 468 capas, perfecto para nuestros ejemplos.</p>
</div>
<div class="section level2">
<h2 id="promedios-climatológicos-estáticos-con-calculate_average">3. Promedios Climatológicos Estáticos con
<code>calculate_average()</code><a class="anchor" aria-label="anchor" href="#promedios-climatol%C3%B3gicos-est%C3%A1ticos-con-calculate_average"></a>
</h2>
<p>Esta es la forma más común de calcular una climatología. Queremos
obtener 12 rásters: uno para el promedio de todos los eneros, uno para
todos los febreros, y así sucesivamente.</p>
<p>El argumento clave aquí es <code>index</code>. Es un vector numérico
que le dice a la función cómo agrupar las capas. Para el primer ejemplo,
vamos a usar 30 años de datos mensuales. Para ello creamos un índice que
repite la secuencia <code>1, 2, ..., 12</code> treinta veces.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Usaremos las primeras 360 capas para nuestro ejemplo de 30 años</span></span>
<span><span class="va">tmax_subset</span> <span class="op">&lt;-</span> <span class="va">tmax_bel</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">360</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Crear el vector de índice: repite la secuencia 1:12 (meses) 30 veces (años)</span></span>
<span><span class="va">index_mensual</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, times <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Crear un directorio temporal para guardar los resultados</span></span>
<span><span class="va">output_path_static</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"tmax_belize_static_avg"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ejecutar la función</span></span>
<span><span class="co"># progressr mostrará una barra de progreso si la operación es larga</span></span>
<span><span class="va">tmax_avg_static</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_average.html">calculate_average</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">tmax_subset</span>,</span>
<span>  index <span class="op">=</span> <span class="va">index_mensual</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">output_path_static</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Permitir sobreescribir si el directorio ya existe</span></span>
<span>  output_names <span class="op">=</span> <span class="st">"tmax_avg"</span> <span class="co"># Prefijo para los archivos de salida</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using 'auto' method to select workflow...</span></span>
<span><span class="co">## Data appears to fit in memory. Selecting 'terra' workflow.</span></span>
<span><span class="co">## Calculating averages using terra::tapp...</span></span>
<span><span class="co">## Writing final GeoTIFFs...</span></span>
<span><span class="co">## Processing complete. Final rasters are in: /tmp/RtmpOKfJiX/tmax_belize_static_avg</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># El resultado es un SpatRaster con 12 capas</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tmax_avg_static</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## size        : 314, 134, 12  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 0.008333333, 0.008333333  (x, y)</span></span>
<span><span class="co">## extent      : -89.22514, -88.10847, 15.88319, 18.49986  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">## sources     : tmax_avg_01.tif  </span></span>
<span><span class="co">##               tmax_avg_02.tif  </span></span>
<span><span class="co">##               tmax_avg_03.tif  </span></span>
<span><span class="co">##               ... and 9 more sources</span></span>
<span><span class="co">## names       : tmax_avg_01, tmax_avg_02, tmax_avg_03, tmax_avg_04, tmax_avg_05, tmax_avg_06, ... </span></span>
<span><span class="co">## min values  :    210.1667,    223.0000,    241.6333,       254.8,    258.8667,    251.6000, ... </span></span>
<span><span class="co">## max values  :    276.4000,    296.5667,    321.5667,       336.9,    339.0667,    320.0333, ...</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Podemos visualizar los 12 promedios mensuales</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tmax_avg_static</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial-2-avg-es_files/figure-html/static-average-1.png" width="700"></p>
<p>¡Listo! <code>tmax_avg_static</code> contiene la climatología de 30
años. La primera capa es el promedio de todos los eneros, la segunda de
todos los febreros, etc.</p>
</div>
<div class="section level2">
<h2 id="promedios-climatológicos-móviles-con-calculate_roll">4. Promedios Climatológicos Móviles con
<code>calculate_roll()</code><a class="anchor" aria-label="anchor" href="#promedios-climatol%C3%B3gicos-m%C3%B3viles-con-calculate_roll"></a>
</h2>
<p>¿Y si queremos ver si el clima está cambiando? En lugar de un único
promedio, podemos calcular promedios para ventanas de tiempo que se
deslizan. Por ejemplo, el promedio de los años 1-20, luego 2-21, 3-22, y
así sucesivamente.</p>
<p>Para esto, usamos <code><a href="../reference/calculate_roll.html">calculate_roll()</a></code>. Sus argumentos clave
son:</p>
<ul>
<li>
<code>window_size</code>: El tamaño de la ventana (en
<strong>ciclos</strong>, por ejemplo, años).</li>
<li>
<code>freq</code>: El número de <strong>unidades</strong> (capas)
por ciclo (e.g., 12 para meses en un año).</li>
</ul>
<div class="section level3">
<h3 id="ejemplo-1-ventana-de-20-años">Ejemplo 1: Ventana de 20 años<a class="anchor" aria-label="anchor" href="#ejemplo-1-ventana-de-20-a%C3%B1os"></a>
</h3>
<p>Calculemos los promedios mensuales para ventanas móviles de 20
años.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Crear un directorio de salida para este análisis</span></span>
<span><span class="va">output_path_rolling</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"tmax_belize_rolling_avg"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmax_roll_avg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_roll.html">calculate_roll</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">tmax_bel</span>,</span>
<span>  window_size <span class="op">=</span> <span class="fl">20</span>, <span class="co"># Una ventana de 20 ciclos (años)</span></span>
<span>  freq <span class="op">=</span> <span class="fl">12</span>,        <span class="co"># 12 unidades (meses) por ciclo</span></span>
<span>  output_dir <span class="op">=</span> <span class="va">output_path_rolling</span>,</span>
<span>  output_prefix <span class="op">=</span> <span class="st">"tmax"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using 'auto' method to select workflow...</span></span>
<span><span class="co">## A single window appears to fit in memory. Selecting 'terra' workflow.</span></span>
<span><span class="co">## Processing window: Cycle 1 to 20</span></span>
<span><span class="co">## Processing window: Cycle 2 to 21</span></span>
<span><span class="co">## Processing window: Cycle 3 to 22</span></span>
<span><span class="co">## Processing window: Cycle 4 to 23</span></span>
<span><span class="co">## Processing window: Cycle 5 to 24</span></span>
<span><span class="co">## Processing window: Cycle 6 to 25</span></span>
<span><span class="co">## Processing window: Cycle 7 to 26</span></span>
<span><span class="co">## Processing window: Cycle 8 to 27</span></span>
<span><span class="co">## Processing window: Cycle 9 to 28</span></span>
<span><span class="co">## Processing window: Cycle 10 to 29</span></span>
<span><span class="co">## Processing window: Cycle 11 to 30</span></span>
<span><span class="co">## Processing window: Cycle 12 to 31</span></span>
<span><span class="co">## Processing window: Cycle 13 to 32</span></span>
<span><span class="co">## Processing window: Cycle 14 to 33</span></span>
<span><span class="co">## Processing window: Cycle 15 to 34</span></span>
<span><span class="co">## Processing window: Cycle 16 to 35</span></span>
<span><span class="co">## Processing window: Cycle 17 to 36</span></span>
<span><span class="co">## Processing window: Cycle 18 to 37</span></span>
<span><span class="co">## Processing window: Cycle 19 to 38</span></span>
<span><span class="co">## Processing window: Cycle 20 to 39</span></span>
<span><span class="co">## Writing final GeoTIFFs...</span></span>
<span><span class="co">## Processing complete. Final rasters are in: /tmp/RtmpOKfJiX/tmax_belize_rolling_avg</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ¿Cuántas capas hemos creado?</span></span>
<span><span class="co"># (39 ciclos - 20 de ventana + 1) * 12 unidades = 20 * 12 = 240 capas</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tmax_roll_avg</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## size        : 314, 134, 240  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 0.008333333, 0.008333333  (x, y)</span></span>
<span><span class="co">## extent      : -89.22514, -88.10847, 15.88319, 18.49986  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">## sources     : tmax_w01-20_u01.tif  </span></span>
<span><span class="co">##               tmax_w01-20_u02.tif  </span></span>
<span><span class="co">##               tmax_w01-20_u03.tif  </span></span>
<span><span class="co">##               ... and 237 more sources</span></span>
<span><span class="co">## names       : tmax_~0_u01, tmax_~0_u02, tmax_~0_u03, tmax_~0_u04, tmax_~0_u05, tmax_~0_u06, ... </span></span>
<span><span class="co">## min values  :       211.6,       223.8,      241.95,      255.55,       259.7,      251.75, ... </span></span>
<span><span class="co">## max values  :       277.0,       296.0,      319.50,      334.80,       340.1,      319.60, ...</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Veamos los nombres de las primeras 13 capas para entender la salida</span></span>
<span><span class="co"># Deberíamos ver los 12 meses para la primera ventana (w1-20) y el primero de la siguiente</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tmax_roll_avg</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">13</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "tmax_w01-20_u01" "tmax_w01-20_u02" "tmax_w01-20_u03" "tmax_w01-20_u04"</span></span>
<span><span class="co">##  [5] "tmax_w01-20_u05" "tmax_w01-20_u06" "tmax_w01-20_u07" "tmax_w01-20_u08"</span></span>
<span><span class="co">##  [9] "tmax_w01-20_u09" "tmax_w01-20_u10" "tmax_w01-20_u11" "tmax_w01-20_u12"</span></span>
<span><span class="co">## [13] "tmax_w02-21_u01"</span></span></code></pre>
<p>Como se puede ver, los nombres de las capas nos indican la ventana
(<code>w1-20</code>) y el índice de la unidad (<code>u</code>).</p>
</div>
<div class="section level3">
<h3 id="ejemplo-2-personalizando-los-nombres-de-salida">Ejemplo 2: Personalizando los Nombres de Salida<a class="anchor" aria-label="anchor" href="#ejemplo-2-personalizando-los-nombres-de-salida"></a>
</h3>
<p>La función es muy flexible gracias al argumento
<code>name_template</code>. Podemos definir exactamente cómo queremos
que se llamen nuestros archivos de salida.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Definir una plantilla de nombres más descriptiva</span></span>
<span><span class="va">template_personalizado</span> <span class="op">&lt;-</span> <span class="st">"{prefix}_año_{start_window}-{end_window}_mes_{idx_unit}"</span></span>
<span></span>
<span><span class="co"># Directorio de salida para el ejemplo con nombres personalizados</span></span>
<span><span class="va">output_path_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"tmax_belize_custom_names"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmax_roll_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_roll.html">calculate_roll</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">tmax_bel</span>,</span>
<span>  window_size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  freq <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">output_path_custom</span>,</span>
<span>  output_prefix <span class="op">=</span> <span class="st">"tmax"</span>,</span>
<span>  name_template <span class="op">=</span> <span class="va">template_personalizado</span>, <span class="co"># Usamos nuestra plantilla</span></span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using 'auto' method to select workflow...</span></span>
<span><span class="co">## A single window appears to fit in memory. Selecting 'terra' workflow.</span></span>
<span><span class="co">## Processing window: Cycle 1 to 20</span></span>
<span><span class="co">## Processing window: Cycle 2 to 21</span></span>
<span><span class="co">## Processing window: Cycle 3 to 22</span></span>
<span><span class="co">## Processing window: Cycle 4 to 23</span></span>
<span><span class="co">## Processing window: Cycle 5 to 24</span></span>
<span><span class="co">## Processing window: Cycle 6 to 25</span></span>
<span><span class="co">## Processing window: Cycle 7 to 26</span></span>
<span><span class="co">## Processing window: Cycle 8 to 27</span></span>
<span><span class="co">## Processing window: Cycle 9 to 28</span></span>
<span><span class="co">## Processing window: Cycle 10 to 29</span></span>
<span><span class="co">## Processing window: Cycle 11 to 30</span></span>
<span><span class="co">## Processing window: Cycle 12 to 31</span></span>
<span><span class="co">## Processing window: Cycle 13 to 32</span></span>
<span><span class="co">## Processing window: Cycle 14 to 33</span></span>
<span><span class="co">## Processing window: Cycle 15 to 34</span></span>
<span><span class="co">## Processing window: Cycle 16 to 35</span></span>
<span><span class="co">## Processing window: Cycle 17 to 36</span></span>
<span><span class="co">## Processing window: Cycle 18 to 37</span></span>
<span><span class="co">## Processing window: Cycle 19 to 38</span></span>
<span><span class="co">## Processing window: Cycle 20 to 39</span></span>
<span><span class="co">## Writing final GeoTIFFs...</span></span>
<span><span class="co">## Processing complete. Final rasters are in: /tmp/RtmpOKfJiX/tmax_belize_custom_names</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Verifiquemos los nuevos nombres</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tmax_roll_custom</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">13</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "tmax_año_01-20_mes_01" "tmax_año_01-20_mes_02" "tmax_año_01-20_mes_03"</span></span>
<span><span class="co">##  [4] "tmax_año_01-20_mes_04" "tmax_año_01-20_mes_05" "tmax_año_01-20_mes_06"</span></span>
<span><span class="co">##  [7] "tmax_año_01-20_mes_07" "tmax_año_01-20_mes_08" "tmax_año_01-20_mes_09"</span></span>
<span><span class="co">## [10] "tmax_año_01-20_mes_10" "tmax_año_01-20_mes_11" "tmax_año_01-20_mes_12"</span></span>
<span><span class="co">## [13] "tmax_año_02-21_mes_01"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="analizando-los-resultados-del-promedio-móvil">Analizando los Resultados del Promedio Móvil<a class="anchor" aria-label="anchor" href="#analizando-los-resultados-del-promedio-m%C3%B3vil"></a>
</h3>
<p>Visualizar 240 capas a la vez no es práctico. Un análisis más
interesante es, por ejemplo, ver cómo ha cambiado el promedio de un mes
específico a lo largo de las ventanas.</p>
<p>Vamos a extraer y visualizar todos los promedios de
<strong>enero</strong> (<code>idx01</code>).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Seleccionar todas las capas que corresponden a enero (índice 01)</span></span>
<span><span class="co"># Usamos grep() para buscar el patrón "_u01" en los nombres de las capas</span></span>
<span><span class="va">indices_enero</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"_u01"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tmax_roll_avg</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Crear un subconjunto del SpatRaster solo con los eneros</span></span>
<span><span class="va">eneros_moviles</span> <span class="op">&lt;-</span> <span class="va">tmax_roll_avg</span><span class="op">[[</span><span class="va">indices_enero</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Cambiemos los nombres para que sean más claros (indican la ventana)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">eneros_moviles</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Enero"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ahora podemos visualizar el cambio entre el primer y último enero</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eneros_moviles</span><span class="op">[[</span><span class="fl">20</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">eneros_moviles</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial-2-avg-es_files/figure-html/analyze-rolling-1.png" width="700"></p>
<p>Este gráfico nos muestra cómo ha cambiado la temperatura máxima
promedio de enero en lso últimos años, permitiéndonos identificar
tendencias de calentamiento o enfriamiento. Es importante mencionar que
las capas usadas de temperatura máxima están multiplicadas por 10. Por
lo cual, existe partes con cambios de hast 0.8 grados centigrados.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusión">Conclusión<a class="anchor" aria-label="anchor" href="#conclusi%C3%B3n"></a>
</h2>
<p>El paquete <code>fastbioclim</code> simplifica enormemente el cálculo
de resúmenes temporales en series de tiempo de rásters. * Usa
<code><a href="../reference/calculate_average.html">calculate_average()</a></code> para climatologías estáticas sobre todo
el período de estudio. * Usa <code><a href="../reference/calculate_roll.html">calculate_roll()</a></code> para analizar
tendencias y cambios a través de ventanas de tiempo móviles.</p>
<p>Ambas funciones están optimizadas para ser eficientes y pueden
aprovechar el procesamiento en paralelo para manejar grandes volúmenes
de datos.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gonzalo E. Pinilla-Buitrago, Luis Osorio-Olvera.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
